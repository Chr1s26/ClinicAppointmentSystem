<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Patient Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
</head>

<body class="bg-light">

<div class="container-fluid">
    <div class="row">

        <div class="col-12 col-md-3 col-lg-2 p-0"
             th:insert="fragments/sidebar :: sidebar"></div>

        <main class="col p-4">

            <h2 class="fw-bold mb-4">Patient Dashboard</h2>

            <!-- PATIENT INFO -->
            <div class="card p-3 mb-4 shadow-sm">
                <h4 class="mb-3">Profile Information</h4>

                <p><strong>Name:</strong> <span th:text="${patient.name}"></span></p>
                <p><strong>Phone:</strong> <span th:text="${patient.phone}"></span></p>
                <p><strong>Address:</strong> <span th:text="${patient.address}"></span></p>

                <p><strong>Linked Account:</strong>
                    <span th:text="${patient.appUser.email}"></span>
                    (<span th:text="${patient.appUser.username}"></span>)
                </p>
            </div>


            <!-- APPOINTMENTS -->
            <div class="card p-3 shadow-sm">
                <h4 class="mb-3">Your Appointments</h4>

                <table class="table table-bordered table-striped">
                    <thead class="table-dark">
                    <tr>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Doctor</th>
                        <th>Department</th>
                        <th>Status</th>
                        <th style="width: 150px">Actions</th>
                    </tr>
                    </thead>

                    <tbody>
                    <tr th:each="a : ${appointments}">
                        <td th:text="${a.appointmentDate}"></td>
                        <td th:text="${a.timeSlot}"></td>
                        <td th:text="${a.doctor.name}"></td>
                        <td th:text="${a.department.departmentName}"></td>

                        <td th:text="${a.appointmentStatus}"
                            th:classappend="${a.appointmentStatus.name() == 'SCHEDULED'} ? 'text-success' : 'text-muted'">
                        </td>

                        <td>
                            <a class="btn btn-warning btn-sm"
                               th:href="@{'/appointments/edit/' + ${a.id}}">
                                Edit
                            </a>

                            <a class="btn btn-danger btn-sm"
                               th:href="@{'/appointments/cancel/' + ${a.id}}">
                                Cancel
                            </a>
                        </td>
                    </tr>
                    </tbody>
                </table>

            </div>

        </main>

    </div>
</div>

</body>
</html>
